–
{C:\Users\pavlo\source\repos\NonamePoc\FanPage\server\FanPage.Backend\FanPage.Domain.Chat\Repos\Interface\IChatRepository.cs
	namespace 	
FanPage
 
. 
Domain 
. 
Chat 
. 
Repos #
.# $
	Interface$ -
;- .
public 
	interface 
IChatRepository  
{ 
Task 
< 	
ChatDto	 
> 
GetChatAsync 
( 
int "
id# %
,% &
string' -
type. 2
)2 3
;3 4
Task		 
<		 	
List			 
<		 
ChatUserDto		 
>		 
>		 
GetChatUsersAsync		 -
(		- .
int		. 1
chatId		2 8
)		8 9
;		9 :
Task 
< 	
List	 
< 
ChatDto 
> 
> 
GetChatsAsync %
(% &
string& ,
type- 1
)1 2
;2 3
Task 
CreateMessageAsync	 
( 
int 
chatId  &
,& '

MessageDto( 2
message3 :
): ;
;; <
Task 
< 	
ChatDto	 
> 
CreateAsync 
( 
ChatDto %
chat& *
)* +
;+ ,
Task 
< 	
List	 
< 
Entities 
. 
Chat 
> 
> 
SearchChatAsync -
(- .
string. 4
search5 ;
); <
;< =
Task 
< 	
ChatDto	 
> 
UpdateAsync 
( 
ChatDto %
chat& *
)* +
;+ ,
Task 
DeleteAsync	 
( 
int 
id 
) 
; 
Task #
RemoveUserFromChatAsync	  
(  !
int! $
chatId% +
,+ ,
string- 3
userId4 :
): ;
;; <
Task 
< 	
List	 
< 
ChatDto 
> 
> 
GetChatRequestAsync +
(+ ,
string, 2
userId3 9
)9 :
;: ;
Task !
InviteUserToChatAsync	 
( 
int "
chatId# )
,) *
string+ 1
userId2 8
,8 9
string: @
userNameA I
)I J
;J K
Task !
AcceptUserToChatAsync	 
( 
int "
chatId# )
,) *
string+ 1
userId2 8
)8 9
;9 :
Task "
DeclineUserToChatAsync	 
(  
int  #
chatId$ *
,* +
string, 2
userId3 9
)9 :
;: ;
}   ÌŒ
uC:\Users\pavlo\source\repos\NonamePoc\FanPage\server\FanPage.Backend\FanPage.Domain.Chat\Repos\Impl\ChatRepository.cs
	namespace 	
FanPage
 
. 
Domain 
. 
Chat 
. 
Repos #
.# $
Impl$ (
;( )
public

 
class

 
ChatRepository

 
:

 
IChatRepository

 -
{ 
private 
readonly 
ChatContext  
_context! )
;) *
private 
readonly 
IMapper 
_mapper $
;$ %
public 

ChatRepository 
( 
ChatContext %
context& -
,- .
IMapper/ 6
mapper7 =
)= >
{ 
_context 
= 
context 
; 
_mapper 
= 
mapper 
; 
} 
public 

async 
Task 
< 
ChatDto 
> 
GetChatAsync +
(+ ,
int, /
id0 2
,2 3
string4 :
type; ?
)? @
{ 
var 
chat 
= 
await 
_context !
.! "
Chats" '
.' (
Where( -
(- .
w. /
=>0 2
type3 7
==8 :
$str; C
||D F
typeG K
==L N
$strO X
)X Y
. 
FirstOrDefaultAsync  
(  !
x! "
=># %
x& '
.' (
Id( *
==+ -
id. 0
&&1 3
x4 5
.5 6
Type6 :
==; =
type> B
)B C
;C D
return 
_mapper 
. 
Map 
< 
ChatDto "
>" #
(# $
chat$ (
)( )
;) *
} 
public 

async 
Task 
< 
List 
< 
ChatUserDto &
>& '
>' (
GetChatUsersAsync) :
(: ;
int; >
chatId? E
)E F
{ 
var 
	chatUsers 
= 
await 
_context &
.& '
	ChatUsers' 0
.   
Where   
(   
w   
=>   
w   
.   
ChatId    
==  ! #
chatId  $ *
&&  + -
w  . /
.  / 0
AcceptedRequest  0 ?
==  @ B
true  C G
)  G H
.!! 
Select!! 
(!! 
s!! 
=>!! 
new!! 
{!! 
s!!  
.!!  !
UserId!!! '
,!!' (
s!!) *
.!!* +
UserName!!+ 3
}!!4 5
)!!5 6
."" 
ToListAsync"" 
("" 
)"" 
;"" 
return$$ 
	chatUsers$$ 
.$$ 
Select$$ 
($$  
s$$  !
=>$$" $
new$$% (
ChatUserDto$$) 4
($$4 5
)$$5 6
{%% 	
UserId&& 
=&& 
s&& 
.&& 
UserId&& 
,&& 
UserName'' 
='' 
s'' 
.'' 
UserName'' !
}(( 	
)((	 

.((
 
ToList(( 
((( 
)(( 
;(( 
})) 
public++ 

async++ 
Task++ 
<++ 
List++ 
<++ 
ChatDto++ "
>++" #
>++# $
GetChatRequestAsync++% 8
(++8 9
string++9 ?
userId++@ F
)++F G
{,, 
var-- 
chats-- 
=-- 
await-- 
_context-- "
.--" #
	ChatUsers--# ,
... 
Where.. 
(.. 
w.. 
=>.. 
w.. 
... 
UserId..  
==..! #
userId..$ *
&&..+ -
w... /
.../ 0
AcceptedRequest..0 ?
==..@ B
false..C H
)..H I
.// 
Select// 
(// 
s// 
=>// 
new// 
{// 
s//  
.//  !
ChatId//! '
,//' (
s//) *
.//* +
Chat//+ /
./// 0
Name//0 4
,//4 5
s//6 7
.//7 8
Chat//8 <
.//< =
Type//= A
}//B C
)//C D
.00 
ToListAsync00 
(00 
)00 
;00 
return22 
chats22 
.22 
Select22 
(22 
s22 
=>22  
new22! $
ChatDto22% ,
(22, -
)22- .
{33 	
Id44 
=44 
s44 
.44 
ChatId44 
,44 
Name55 
=55 
s55 
.55 
Name55 
,55 
Type66 
=66 
s66 
.66 
Type66 
}77 	
)77	 

.77
 
ToList77 
(77 
)77 
;77 
}88 
public:: 

async:: 
Task:: 
<:: 
List:: 
<:: 
ChatDto:: "
>::" #
>::# $
GetChatsAsync::% 2
(::2 3
string::3 9
type::: >
)::> ?
{;; 
var<< 
chats<< 
=<< 
await<< 
_context<< "
.<<" #
Chats<<# (
.<<( )
Where<<) .
(<<. /
w<</ 0
=><<1 3
type<<4 8
==<<9 ;
$str<<< D
)<<D E
.<<E F
ToListAsync<<F Q
(<<Q R
)<<R S
;<<S T
return== 
_mapper== 
.== 
Map== 
<== 
List== 
<==  
ChatDto==  '
>==' (
>==( )
(==) *
chats==* /
)==/ 0
;==0 1
}>> 
public@@ 

async@@ 
Task@@ 
CreateMessageAsync@@ (
(@@( )
int@@) ,
chatId@@- 3
,@@3 4

MessageDto@@5 ?
message@@@ G
)@@G H
{AA 
varBB 
messageEntityBB 
=BB 
_mapperBB #
.BB# $
MapBB$ '
<BB' (
MessageBB( /
>BB/ 0
(BB0 1
messageBB1 8
)BB8 9
;BB9 :
varDD 
existingChatDD 
=DD 
awaitDD  
_contextDD! )
.DD) *
ChatsDD* /
.DD/ 0
FirstOrDefaultAsyncDD0 C
(DDC D
xDDD E
=>DDF H
xDDI J
.DDJ K
IdDDK M
==DDN P
chatIdDDQ W
)DDW X
;DDX Y
ifEE 

(EE 
existingChatEE 
==EE 
nullEE  
)EE  !
{FF 	
throwGG 
newGG 
	ExceptionGG 
(GG  
$strGG  0
)GG0 1
;GG1 2
}HH 	
messageEntityJJ 
.JJ 
ChatIdJJ 
=JJ 
chatIdJJ %
;JJ% &
awaitKK 
_contextKK 
.KK 
MessagesKK 
.KK  
AddAsyncKK  (
(KK( )
messageEntityKK) 6
)KK6 7
;KK7 8
awaitLL 
_contextLL 
.LL 
SaveChangesAsyncLL '
(LL' (
)LL( )
;LL) *
}MM 
publicOO 

asyncOO 
TaskOO 
<OO 
ChatDtoOO 
>OO 
CreateAsyncOO *
(OO* +
ChatDtoOO+ 2
chatOO3 7
)OO7 8
{PP 
varQQ 

chatEntityQQ 
=QQ 
_mapperQQ  
.QQ  !
MapQQ! $
<QQ$ %
EntitiesQQ% -
.QQ- .
ChatQQ. 2
>QQ2 3
(QQ3 4
chatQQ4 8
)QQ8 9
;QQ9 :
awaitRR 
_contextRR 
.RR 
ChatsRR 
.RR 
AddAsyncRR %
(RR% &

chatEntityRR& 0
)RR0 1
;RR1 2
awaitSS 
_contextSS 
.SS 
SaveChangesAsyncSS '
(SS' (
)SS( )
;SS) *
returnUU 
_mapperUU 
.UU 
MapUU 
<UU 
ChatDtoUU "
>UU" #
(UU# $

chatEntityUU$ .
)UU. /
;UU/ 0
}VV 
publicXX 

asyncXX 
TaskXX 
<XX 
ListXX 
<XX 
EntitiesXX #
.XX# $
ChatXX$ (
>XX( )
>XX) *
SearchChatAsyncXX+ :
(XX: ;
stringXX; A
searchXXB H
)XXH I
{YY 
varZZ 
searchWorldZZ 
=ZZ 
searchZZ  
.ZZ  !
SplitZZ! &
(ZZ& '
$charZZ' *
)ZZ* +
;ZZ+ ,
var\\ 
query\\ 
=\\ 
_context\\ 
.\\ 
Chats\\ "
.\\" #
AsQueryable\\# .
(\\. /
)\\/ 0
;\\0 1
query^^ 
=^^ 
searchWorld^^ 
.^^ 
	Aggregate^^ %
(^^% &
query^^& +
,^^+ ,
(^^- .
current^^. 5
,^^5 6
word^^7 ;
)^^; <
=>^^= ?
current^^@ G
.^^G H
Where^^H M
(^^M N
w^^N O
=>^^P R
w^^S T
.^^T U
Name^^U Y
.^^Y Z
Contains^^Z b
(^^b c
word^^c g
)^^g h
)^^h i
)^^i j
;^^j k
var`` 
chat`` 
=`` 
await`` 
query`` 
.`` 
ToListAsync`` *
(``* +
)``+ ,
;``, -
returnbb 
chatbb 
;bb 
}cc 
publicee 

asyncee 
Taskee 
<ee 
ChatDtoee 
>ee 
UpdateAsyncee *
(ee* +
ChatDtoee+ 2
chatee3 7
)ee7 8
{ff 
vargg 

chatEntitygg 
=gg 
_mappergg  
.gg  !
Mapgg! $
<gg$ %
Entitiesgg% -
.gg- .
Chatgg. 2
>gg2 3
(gg3 4
chatgg4 8
)gg8 9
;gg9 :
_contexthh 
.hh 
Chatshh 
.hh 
Updatehh 
(hh 

chatEntityhh (
)hh( )
;hh) *
awaitii 
_contextii 
.ii 
SaveChangesAsyncii '
(ii' (
)ii( )
;ii) *
returnkk 
_mapperkk 
.kk 
Mapkk 
<kk 
ChatDtokk "
>kk" #
(kk# $

chatEntitykk$ .
)kk. /
;kk/ 0
}ll 
publicnn 

asyncnn 
Tasknn 
DeleteAsyncnn !
(nn! "
intnn" %
idnn& (
)nn( )
{oo 
varpp 
chatpp 
=pp 
_contextpp 
.pp 
Chatspp !
.pp! "
FirstOrDefaultpp" 0
(pp0 1
xpp1 2
=>pp3 5
xpp6 7
.pp7 8
Idpp8 :
==pp; =
idpp> @
)pp@ A
;ppA B
ifqq 

(qq 
chatqq 
!=qq 
nullqq 
)qq 
_contextqq "
.qq" #
Chatsqq# (
.qq( )
Removeqq) /
(qq/ 0
chatqq0 4
)qq4 5
;qq5 6
elserr 
throwrr 
newrr 
	Exceptionrr  
(rr  !
$strrr! 1
)rr1 2
;rr2 3
awaitss 
_contextss 
.ss 
SaveChangesAsyncss '
(ss' (
)ss( )
;ss) *
}tt 
publicvv 

asyncvv 
Taskvv #
RemoveUserFromChatAsyncvv -
(vv- .
intvv. 1
chatIdvv2 8
,vv8 9
stringvv: @
userIdvvA G
)vvG H
{ww 
varxx 
chatUserxx 
=xx 
awaitxx 
_contextxx %
.xx% &
	ChatUsersxx& /
.xx/ 0
FirstOrDefaultAsyncxx0 C
(xxC D
xxxD E
=>xxF H
xxxI J
.xxJ K
ChatIdxxK Q
==xxR T
chatIdxxU [
&&xx\ ^
xxx_ `
.xx` a
UserIdxxa g
==xxh j
userIdxxk q
)xxq r
;xxr s
ifyy 

(yy 
chatUseryy 
!=yy 
nullyy 
)yy 
_contextyy &
.yy& '
	ChatUsersyy' 0
.yy0 1
Removeyy1 7
(yy7 8
chatUseryy8 @
)yy@ A
;yyA B
elsezz 
throwzz 
newzz 
	Exceptionzz  
(zz  !
$strzz! 6
)zz6 7
;zz7 8
await{{ 
_context{{ 
.{{ 
SaveChangesAsync{{ '
({{' (
){{( )
;{{) *
}|| 
public~~ 

async~~ 
Task~~ !
InviteUserToChatAsync~~ +
(~~+ ,
int~~, /
chatId~~0 6
,~~6 7
string~~8 >
userId~~? E
,~~E F
string~~G M
userName~~N V
)~~V W
{ 
var
€€ 
chatUser
€€ 
=
€€ 
await
€€ 
_context
€€ %
.
€€% &
	ChatUsers
€€& /
.
€€/ 0!
FirstOrDefaultAsync
€€0 C
(
€€C D
x
€€D E
=>
€€F H
x
€€I J
.
€€J K
ChatId
€€K Q
==
€€R T
chatId
€€U [
&&
€€\ ^
x
€€_ `
.
€€` a
UserId
€€a g
==
€€h j
userId
€€k q
)
€€q r
;
€€r s
if
‚‚ 

(
‚‚ 
chatUser
‚‚ 
!=
‚‚ 
null
‚‚ 
)
‚‚ 
{
ƒƒ 	
throw
„„ 
new
„„ 
	Exception
„„ 
(
„„  
$str
„„  9
)
„„9 :
;
„„: ;
}
…… 	
chatUser
‡‡ 
=
‡‡ 
new
‡‡ 
ChatUser
‡‡ 
{
ˆˆ 	
UserId
‰‰ 
=
‰‰ 
userId
‰‰ 
,
‰‰ 
UserName
ŠŠ 
=
ŠŠ 
userName
ŠŠ 
,
ŠŠ  
ChatId
‹‹ 
=
‹‹ 
chatId
‹‹ 
,
‹‹ 
AcceptedRequest
ŒŒ 
=
ŒŒ 
false
ŒŒ #
}
 	
;
	 

_context
 
.
 
	ChatUsers
 
.
 
Add
 
(
 
chatUser
 '
)
' (
;
( )
await
 
_context
 
.
 
SaveChangesAsync
 '
(
' (
)
( )
;
) *
}
‘‘ 
public
““ 

async
““ 
Task
““ #
AcceptUserToChatAsync
““ +
(
““+ ,
int
““, /
chatId
““0 6
,
““6 7
string
““8 >
userId
““? E
)
““E F
{
”” 
var
•• 
chatUser
•• 
=
•• 
await
•• 
_context
•• %
.
••% &
	ChatUsers
••& /
.
••/ 0!
FirstOrDefaultAsync
••0 C
(
••C D
x
••D E
=>
••F H
x
••I J
.
••J K
ChatId
••K Q
==
••R T
chatId
••U [
&&
••\ ^
x
••_ `
.
••` a
UserId
••a g
==
••h j
userId
••k q
)
••q r
;
••r s
if
—— 

(
—— 
chatUser
—— 
==
—— 
null
—— 
)
—— 
{
˜˜ 	
throw
™™ 
new
™™ 
	Exception
™™ 
(
™™  
$str
™™  5
)
™™5 6
;
™™6 7
}
šš 	
chatUser
œœ 
.
œœ 
AcceptedRequest
œœ  
=
œœ! "
true
œœ# '
;
œœ' (
await
 
_context
 
.
 
SaveChangesAsync
 '
(
' (
)
( )
;
) *
}
žž 
public
   

async
   
Task
   $
DeclineUserToChatAsync
   ,
(
  , -
int
  - 0
chatId
  1 7
,
  7 8
string
  9 ?
userId
  @ F
)
  F G
{
¡¡ 
var
¢¢ 
chatUser
¢¢ 
=
¢¢ 
await
¢¢ 
_context
¢¢ %
.
¢¢% &
	ChatUsers
¢¢& /
.
¢¢/ 0!
FirstOrDefaultAsync
¢¢0 C
(
¢¢C D
x
¢¢D E
=>
¢¢F H
x
¢¢I J
.
¢¢J K
ChatId
¢¢K Q
==
¢¢R T
chatId
¢¢U [
&&
¢¢\ ^
x
¢¢_ `
.
¢¢` a
UserId
¢¢a g
==
¢¢h j
userId
¢¢k q
)
¢¢q r
;
¢¢r s
if
¤¤ 

(
¤¤ 
chatUser
¤¤ 
==
¤¤ 
null
¤¤ 
)
¤¤ 
{
¥¥ 	
throw
¦¦ 
new
¦¦ 
	Exception
¦¦ 
(
¦¦  
$str
¦¦  5
)
¦¦5 6
;
¦¦6 7
}
§§ 	
_context
©© 
.
©© 
	ChatUsers
©© 
.
©© 
Remove
©© !
(
©©! "
chatUser
©©" *
)
©©* +
;
©©+ ,
await
ªª 
_context
ªª 
.
ªª 
SaveChangesAsync
ªª '
(
ªª' (
)
ªª( )
;
ªª) *
}
«« 
}¬¬ Ä
xC:\Users\pavlo\source\repos\NonamePoc\FanPage\server\FanPage.Backend\FanPage.Domain.Chat\Migrations\20240123193421_v2.cs
	namespace 	
FanPage
 
. 
Domain 
. 
Chat 
. 

Migrations (
{ 
public 

partial 
class 
v2 
: 
	Migration '
{		 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
	AddColumn &
<& '
bool' +
>+ ,
(, -
name 
: 
$str '
,' (
table 
: 
$str "
," #
type 
: 
$str 
,  
nullable 
: 
false 
,  
defaultValue 
: 
false #
)# $
;$ %
migrationBuilder 
. 
	AddColumn &
<& '
string' -
>- .
(. /
name 
: 
$str "
," #
table 
: 
$str 
, 
type 
: 
$str 
, 
nullable 
: 
false 
,  
defaultValue 
: 
$str  
)  !
;! "
migrationBuilder 
. 
	AddColumn &
<& '
string' -
>- .
(. /
name 
: 
$str 
, 
table 
: 
$str 
, 
type 
: 
$str 
, 
nullable 
: 
false 
,  
defaultValue   
:   
$str    
)    !
;  ! "
}!! 	
	protected$$ 
override$$ 
void$$ 
Down$$  $
($$$ %
MigrationBuilder$$% 5
migrationBuilder$$6 F
)$$F G
{%% 	
migrationBuilder&& 
.&& 

DropColumn&& '
(&&' (
name'' 
:'' 
$str'' '
,''' (
table(( 
:(( 
$str(( "
)((" #
;((# $
migrationBuilder** 
.** 

DropColumn** '
(**' (
name++ 
:++ 
$str++ "
,++" #
table,, 
:,, 
$str,, 
),, 
;,,  
migrationBuilder.. 
... 

DropColumn.. '
(..' (
name// 
:// 
$str// 
,// 
table00 
:00 
$str00 
)00 
;00  
}11 	
}22 
}33 ÇG
xC:\Users\pavlo\source\repos\NonamePoc\FanPage\server\FanPage.Backend\FanPage.Domain.Chat\Migrations\20240119184112_v1.cs
	namespace 	
FanPage
 
. 
Domain 
. 
Chat 
. 

Migrations (
{ 
public

 

partial

 
class

 
v1

 
:

 
	Migration

 '
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str 
, 
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 :
,: ;
nullable< D
:D E
falseF K
)K L
. 

Annotation #
(# $
$str$ D
,D E)
NpgsqlValueGenerationStrategyF c
.c d#
IdentityByDefaultColumnd {
){ |
,| }
Name 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
type0 4
:4 5
$str6 <
,< =
nullable> F
:F G
falseH M
)M N
,N O
Description 
=  !
table" '
.' (
Column( .
<. /
string/ 5
>5 6
(6 7
type7 ;
:; <
$str= C
,C D
nullableE M
:M N
falseO T
)T U
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% /
,/ 0
x1 2
=>3 5
x6 7
.7 8
Id8 :
): ;
;; <
} 
) 
; 
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str !
,! "
columns 
: 
table 
=> !
new" %
{   
Id!! 
=!! 
table!! 
.!! 
Column!! %
<!!% &
int!!& )
>!!) *
(!!* +
type!!+ /
:!!/ 0
$str!!1 :
,!!: ;
nullable!!< D
:!!D E
false!!F K
)!!K L
."" 

Annotation"" #
(""# $
$str""$ D
,""D E)
NpgsqlValueGenerationStrategy""F c
.""c d#
IdentityByDefaultColumn""d {
)""{ |
,""| }
UserId## 
=## 
table## "
.##" #
Column### )
<##) *
string##* 0
>##0 1
(##1 2
type##2 6
:##6 7
$str##8 >
,##> ?
nullable##@ H
:##H I
false##J O
)##O P
,##P Q
UserName$$ 
=$$ 
table$$ $
.$$$ %
Column$$% +
<$$+ ,
string$$, 2
>$$2 3
($$3 4
type$$4 8
:$$8 9
$str$$: @
,$$@ A
nullable$$B J
:$$J K
false$$L Q
)$$Q R
,$$R S
ChatId%% 
=%% 
table%% "
.%%" #
Column%%# )
<%%) *
int%%* -
>%%- .
(%%. /
type%%/ 3
:%%3 4
$str%%5 >
,%%> ?
nullable%%@ H
:%%H I
false%%J O
)%%O P
}&& 
,&& 
constraints'' 
:'' 
table'' "
=>''# %
{(( 
table)) 
.)) 

PrimaryKey)) $
())$ %
$str))% 3
,))3 4
x))5 6
=>))7 9
x)): ;
.)); <
Id))< >
)))> ?
;))? @
table** 
.** 

ForeignKey** $
(**$ %
name++ 
:++ 
$str++ 9
,++9 :
column,, 
:,, 
x,,  !
=>,," $
x,,% &
.,,& '
ChatId,,' -
,,,- .
principalTable-- &
:--& '
$str--( /
,--/ 0
principalColumn.. '
:..' (
$str..) -
,..- .
onDelete//  
://  !
ReferentialAction//" 3
.//3 4
Cascade//4 ;
)//; <
;//< =
}00 
)00 
;00 
migrationBuilder22 
.22 
CreateTable22 (
(22( )
name33 
:33 
$str33  
,33  !
columns44 
:44 
table44 
=>44 !
new44" %
{55 
Id66 
=66 
table66 
.66 
Column66 %
<66% &
int66& )
>66) *
(66* +
type66+ /
:66/ 0
$str661 :
,66: ;
nullable66< D
:66D E
false66F K
)66K L
.77 

Annotation77 #
(77# $
$str77$ D
,77D E)
NpgsqlValueGenerationStrategy77F c
.77c d#
IdentityByDefaultColumn77d {
)77{ |
,77| }
UserId88 
=88 
table88 "
.88" #
Column88# )
<88) *
string88* 0
>880 1
(881 2
type882 6
:886 7
$str888 >
,88> ?
nullable88@ H
:88H I
false88J O
)88O P
,88P Q
Content99 
=99 
table99 #
.99# $
Column99$ *
<99* +
string99+ 1
>991 2
(992 3
type993 7
:997 8
$str999 ?
,99? @
nullable99A I
:99I J
false99K P
)99P Q
,99Q R
ReceivedDateUtc:: #
=::$ %
table::& +
.::+ ,
Column::, 2
<::2 3
DateTimeOffset::3 A
>::A B
(::B C
type::C G
:::G H
$str::I c
,::c d
nullable::e m
:::m n
false::o t
)::t u
,::u v
ChatId;; 
=;; 
table;; "
.;;" #
Column;;# )
<;;) *
int;;* -
>;;- .
(;;. /
type;;/ 3
:;;3 4
$str;;5 >
,;;> ?
nullable;;@ H
:;;H I
false;;J O
);;O P
}<< 
,<< 
constraints== 
:== 
table== "
=>==# %
{>> 
table?? 
.?? 

PrimaryKey?? $
(??$ %
$str??% 2
,??2 3
x??4 5
=>??6 8
x??9 :
.??: ;
Id??; =
)??= >
;??> ?
table@@ 
.@@ 

ForeignKey@@ $
(@@$ %
nameAA 
:AA 
$strAA 8
,AA8 9
columnBB 
:BB 
xBB  !
=>BB" $
xBB% &
.BB& '
ChatIdBB' -
,BB- .
principalTableCC &
:CC& '
$strCC( /
,CC/ 0
principalColumnDD '
:DD' (
$strDD) -
,DD- .
onDeleteEE  
:EE  !
ReferentialActionEE" 3
.EE3 4
CascadeEE4 ;
)EE; <
;EE< =
}FF 
)FF 
;FF 
migrationBuilderHH 
.HH 
CreateIndexHH (
(HH( )
nameII 
:II 
$strII +
,II+ ,
tableJJ 
:JJ 
$strJJ "
,JJ" #
columnKK 
:KK 
$strKK  
)KK  !
;KK! "
migrationBuilderMM 
.MM 
CreateIndexMM (
(MM( )
nameNN 
:NN 
$strNN *
,NN* +
tableOO 
:OO 
$strOO !
,OO! "
columnPP 
:PP 
$strPP  
)PP  !
;PP! "
}QQ 	
	protectedTT 
overrideTT 
voidTT 
DownTT  $
(TT$ %
MigrationBuilderTT% 5
migrationBuilderTT6 F
)TTF G
{UU 	
migrationBuilderVV 
.VV 
	DropTableVV &
(VV& '
nameWW 
:WW 
$strWW !
)WW! "
;WW" #
migrationBuilderYY 
.YY 
	DropTableYY &
(YY& '
nameZZ 
:ZZ 
$strZZ  
)ZZ  !
;ZZ! "
migrationBuilder\\ 
.\\ 
	DropTable\\ &
(\\& '
name]] 
:]] 
$str]] 
)]] 
;]] 
}^^ 	
}__ 
}`` ¨

lC:\Users\pavlo\source\repos\NonamePoc\FanPage\server\FanPage.Backend\FanPage.Domain.Chat\Entities\Message.cs
	namespace 	
FanPage
 
. 
Domain 
. 
Chat 
. 
Entities &
;& '
public 
class 
Message 
: 
IEntity 
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public 

string 
UserId 
{ 
get 
; 
set  #
;# $
}% &
public		 

string		 
Content		 
{		 
get		 
;		  
set		! $
;		$ %
}		& '
public 

DateTimeOffset 
ReceivedDateUtc )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
public 

Chat 
Chat 
{ 
get 
; 
set 
;  
}! "
public 

int 
ChatId 
{ 
get 
; 
set  
;  !
}" #
} è
lC:\Users\pavlo\source\repos\NonamePoc\FanPage\server\FanPage.Backend\FanPage.Domain.Chat\Entities\IEntity.cs
	namespace 	
FanPage
 
. 
Domain 
. 
Chat 
. 
Entities &
;& '
public 
	interface 
IEntity 
{ 
} ý	
mC:\Users\pavlo\source\repos\NonamePoc\FanPage\server\FanPage.Backend\FanPage.Domain.Chat\Entities\ChatUser.cs
	namespace 	
FanPage
 
. 
Domain 
. 
Chat 
. 
Entities &
;& '
public 
class 
ChatUser 
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public 

string 
UserId 
{ 
get 
; 
set  #
;# $
}% &
public		 

string		 
UserName		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
public 

Chat 
Chat 
{ 
get 
; 
set 
;  
}! "
public 

bool 
AcceptedRequest 
{  !
get" %
;% &
set' *
;* +
}, -
public 

int 
ChatId 
{ 
get 
; 
set  
;  !
}" #
} ¬
iC:\Users\pavlo\source\repos\NonamePoc\FanPage\server\FanPage.Backend\FanPage.Domain.Chat\Entities\Chat.cs
	namespace 	
FanPage
 
. 
Domain 
. 
Chat 
. 
Entities &
;& '
public 
class 
Chat 
: 
IEntity 
{ 
public 

int 
Id 
{ 
get 
; 
set 
; 
} 
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
public		 

string		 
Description		 
{		 
get		  #
;		# $
set		% (
;		( )
}		* +
public 

string 
Type 
{ 
get 
; 
set !
;! "
}# $
public 

string 

AuthorName 
{ 
get "
;" #
set$ '
;' (
}) *
public 

ICollection 
< 
ChatUser 
>  
	ChatUsers! *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
public 

ICollection 
< 
Message 
> 
Messages  (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
} Œ
oC:\Users\pavlo\source\repos\NonamePoc\FanPage\server\FanPage.Backend\FanPage.Domain.Chat\Context\ChatContext.cs
	namespace 	
FanPage
 
. 
Domain 
. 
Chat 
. 
Context %
;% &
public 
class 
ChatContext 
: 
	DbContext $
{ 
public 

ChatContext 
( 
DbContextOptions '
<' (
ChatContext( 3
>3 4
options5 <
)< =
:> ?
base@ D
(D E
optionsE L
)L M
{ 
}		 
public 

DbSet 
< 
Entities 
. 
Chat 
> 
Chats  %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 

DbSet 
< 
Entities 
. 
Message !
>! "
Messages# +
{, -
get. 1
;1 2
set3 6
;6 7
}8 9
public 

DbSet 
< 
Entities 
. 
ChatUser "
>" #
	ChatUsers$ -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
} 